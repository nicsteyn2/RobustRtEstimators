{
  "hash": "0453d3ed27633b88a25503ce8eb6e5a4",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Robust Rt estimation\"\n---\n\n\n\n\nWe provide simple Julia implementations of two popular methods for reproduction number estimation: EpiEstim [@coriNewFrameworkSoftware2013] and EpiFilter [@paragImprovedEstimationTimevarying2021]. In addition to the original methods, we also provide functions for calculating model likelihoods and marginalising out uncertainty about model parameters from final estimates of $R_t$. \n\nThese scripts were developed as part of *[Robust uncertainty quantification in popular estimators of the instantaneous reproduction number](https://doi.org/10.1101/2024.10.22.24315918)*. All technical details can be found in this paper and the corresponding supplementary material.\n\nWhile the paper above focuses on real-time estimation, we also provide a discussion and comparison of retrospective methods.\n\n::: {#1ffe31ee .cell fig-label='fig-example' execution_count=1}\n``` {.julia .cell-code code-fold=\"true\"}\nusing Plots, Measures\n\n# Ensure we are working in the root directory\nconst rootdir = @__DIR__\ncd(joinpath(rootdir, \"..\"))\n\n# Load scripts\ninclude(\"src/EpiEstim.jl\")\ninclude(\"src/support.jl\")\n\n# Set k parameter and load data\nk = 7\n(Ct, w) = loadData(\"NZCOVID\")\ndates = Date(\"2020-02-26\") + Day.(0:99)\n\n# Run the model and extract mean and credible intervals\npR = EpiEstim(k, w, Ct)\nm = mean.(pR)\nl = quantile.(pR, 0.025)\nu = quantile.(pR, 0.975)\n\n# Plot\nplot_cases = bar(dates, Ct, xlabel=\"Date\", ylabel=\"Reported cases\", label=false, size=(800, 400), margins=3mm, color=\"#f25a2a\")\nplot_Rt = plot(dates, m, ribbon=(m-l,u-m), label=false, xlabel=\"Date\", ylabel=\"Reproduction number\", size=(800,400), margins=3mm, color=\"#13643f\")\nhline!(plot_Rt, [1], label=false, color=:black, linestyle=:dash)\nplot(plot_cases, plot_Rt, layout=(2,1), size=(800,600))\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n![Reported cases from the first 100 days of the COVID-19 pandemic in Aotearoa New Zealand (upper) and the estimated reproduction number using EpiEstim with a default smoothing value of k = 7 (lower). Data were obtained from the [Ministry of Health](https://github.com/minhealthnz/nz-covid-data).](index_files/figure-html/cell-2-output-1.svg){}\n:::\n:::\n\n\nOther than a [Julia installation](https://julialang.org), no external software is required to run this code. All functions are provided in the ``/src/`` directory of the [GitHub repository](https://github.com/nicsteyn2/RobustRtEstimators).\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}